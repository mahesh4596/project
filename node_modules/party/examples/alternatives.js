
/**
 * Module dependencies.
 */

var party = require('../')
  , fs = require('fs')
  , file = __dirname + '/../test/cases/alternatives'
  , str = fs.readFileSync(file, 'ascii').replace(/\n/g, '\r\n')
  , str = new Buffer(str);

var parser = party.createParser('0016e6db2c7a28992004a483da69');

parser.on('part', function(part){
  console.log('\nPART:');
  console.log(part.header);
  if (part.is('multipart/alternative')) {
    var alts = party.createParser(part.boundary);
    part.pipe(alts);
    alts.on('part', function(part){
      console.log('\nALT PART:');
      console.log(part.header);
      part.pipe(process.stderr);
    });

    alts.on('end', function(){
      console.log('\nEND ALTS');
    });
  }
});

parser.on('end', function(){
  console.log('\nEND');
});

parser.parse(str);
