
/**
 * Module dependencies.
 */

var assert = require('assert')
  , helpers = require('../helpers');

exports.boundary = '0016e6db2c7a28991a04a483da67';

exports.test = function(parser, next){
  var n = 0;
  parser.on('part', function(part){
    switch (n++) {
      case 0:
        part.header.should.have.property('content-type', 'text/plain; charset=iso-8859-1');
        var buf = '';
        part.on('data', function(chunk){ buf += chunk });
        part.on('end', function(){
          helpers.assert(buf, 'small.0');
        });
        break;
      case 1:
        part.header.should.have.property('content-type', 'text/html; charset=utf-8');
        var buf = '';
        part.on('data', function(chunk){ buf += chunk });
        part.on('end', function(){
          helpers.assert(buf, 'small.1');
        });
        next();
        break;
    }
  });
};